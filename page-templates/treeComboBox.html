<!DOCTYPE html>
<html lang="en">

@@include('includes/head.html', {"title": "TrivialTreeComboBox - Trivial Components"})

<body data-spy="scroll" data-target="#navbar">

@@include('includes/nav.html', {"activeNavLink": "showcase"})

<div class="page-content">

    <section class="page-header-box">
        <h1 class="project-name">TrivialTreeComboBox</h1>
    </section>

    <div class="container">

        @@include('includes/status-note.html', {"status": "alpha"})

        <div class="row">
            <div class="col-sm-5">
                <h3>Options</h3>
                <form id="config">
                    <div class="checkbox">
                        <label>
                            <input type="checkbox" id="showTrigger" name="showTrigger" checked="checked"> showTrigger
                        </label>
                    </div>
                    <div class="checkbox">
                        <label>
                            <input type="checkbox" id="customQueryFunction" name="customQueryFunction"> use custom query function (1s delay)
                        </label>
                    </div>
                    <div class="checkbox">
                        <label>
                            <input type="checkbox" id="autoComplete" name="autoComplete" checked> autoComplete
                        </label>
                    </div>
                    <div class="form-group">
                        <label for="editingMode">editingMode</label>
                        <input id="editingMode" name="editingMode"/>
                    </div>
                    <div class="form-group">
                        <label for="autoCompleteDelay">autoCompleteDelay (ms)</label>
                        <input class="form-control" id="autoCompleteDelay" name="autoCompleteDelay" type="number" value="0"/>
                    </div>
                    <div class="checkbox">
                        <label>
                            <input type="checkbox" id="allowFreeText" name="allowFreeText"> allowFreeText
                        </label>
                    </div>
                    <div class="form-group">
                        <label for="freeTextEntryValues">freeTextEntryValues</label>
                        <textarea class="form-control code showcase-textarea" id="freeTextEntryValues" name="freeTextEntryValues">{
    "_isFreeTextEntry": true
}</textarea>
                    </div>
                    <div class="form-group">
                        <label for="valueProperty">valueProperty</label>
                        <input class="form-control" id="valueProperty" name="valueProperty" value="id"/>
                    </div>
                    <div class="form-group">
                        <label for="inputTextProperty">inputTextProperty</label>
                        <input class="form-control" id="inputTextProperty" name="inputTextProperty" value="displayValue"/>
                    </div>
                    <div class="form-group">
                        <label for="childrenProperty">childrenProperty</label>
                        <input class="form-control" id="childrenProperty" name="childrenProperty" value="children"/>
                    </div>
                    <div class="form-group">
                        <label for="expandedProperty">expandedProperty</label>
                        <input class="form-control" id="expandedProperty" name="expandedProperty" value="expanded"/>
                    </div>
                    <div class="form-group">
                        <label for="matchingMode">matchingMode</label>
                        <input id="matchingMode" name="matchingMode"/>
                    </div>
                    <div class="checkbox">
                        <label>
                            <input type="checkbox" id="ignoreCase" name="ignoreCase" checked="checked"> ignoreCase
                        </label>
                    </div>
                    <div class="form-group">
                        <label for="animationDuration">animationDuration (ms)</label>
                        <input class="form-control" id="animationDuration" name="animationDuration" type="number" value="70"/>
                    </div>
                    <div class="form-group">
                        <label for="selectedEntryTemplate">selectedEntryTemplate</label>
                        <input id="selectedEntryTemplate" name="selectedEntryTemplate"/>
                    </div>
                    <div class="form-group">
                        <label for="templates">templates</label>
                        <input id="templates" name="templates"/>
                    </div>
                    <div class="form-group">
                        <label for="spinnerTemplate">spinnerTemplate</label>
                        <textarea class="form-control code showcase-textarea" id="spinnerTemplate" name="spinnerTemplate"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="noEntriesTemplate">noEntriesTemplate</label>
                        <textarea class="form-control code showcase-textarea" id="noEntriesTemplate" name="noEntriesTemplate"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="entries">entries</label>
                <textarea class="form-control code showcase-textarea" id="entries" name="entries">
                </textarea>
                    </div>
                    <div class="form-group">
                        <label for="selectedEntry">selectedEntry</label>
                <textarea class="form-control code showcase-textarea" id="selectedEntry" name="selectedEntryId">{
    "id": 151,
    "displayValue": "Project X",
    "additionalInfo": "4 unread",
    "imageUrl": "img/icons/folder.png",
    "isLeaf": true

}</textarea>
                    </div>
                    <div class="form-group">
                        <label for="emptyEntry">emptyEntry</label>
                <textarea class="form-control code showcase-textarea" id="emptyEntry" name="emptyEntry">{
    "displayValue": "Please select...",
    "imageUrl": "-",
    "additionalInfo": ""
}</textarea>
                    </div>
                </form>
            </div>
            <div class="col-sm-7">
                <h3>Result</h3>
                <div id="treeComboBoxWrapper"></div>
                <h4>Original input value</h4>
                <code id="originalInputValue"></code>
                <h4>Selected entry</h4>
                <pre id="selectedEntryDisplay" class="prettyprint lang-js"></pre>
                <h3>Configuration</h3>
                <pre id="configDisplay" class="prettyprint lang-js"></pre>
            </div>
        </div>



        <h3>Configuration Options<a class="anchor" id="configuration"></a></h3>
        <div class="table-responsive">
            <table class="table table-condensed table-hover">
                <thead>
                <tr>
                    <th>Option</th>
                    <th>Description</th>
                    <th>Default</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>valueProperty</td>
                    <td>Name of the property which should be submitted on form submit. If
                        <code>null</code>, then the content of the text input will serve als value.
                        Additionally, this property serves to identify nodes in the tree, so it must be unique.
                        <div class="alert alert-danger">TODO: This is not consistent. Separate valueProperty and idProperty!</div>
                    </td>
                    <td><code>null</code></td>
                </tr>
                <tr>
                    <td>allowFreeText</td>
                    <td>
                        Allow free text input.<br/>
                        If <code>true</code>, the user is not forced to select one of the suggested entries but can type whatever he wants into the field. If the user leaves the field without selecting any of the suggested values, then his input remains visible. In this case, <code>getSelectedEntry()</code> returns a fake entry with the <code>[inputTextProperty]</code> property set.<br/>
                        If <code>false</code>, the user input will be deleted if he does not select a suggested entry.<br/>
                    </td>
                    <td><code>false</code></td>
                </tr>
                <tr>
                    <td>freeTextEntryValues</td>
                    <td>If <code>allowFreeText == true</code> this property defines values that should be set on a fake entry (in addition to the <code>[inputTextProperty]</code> property). returned by <code>getSelectedEntry()</code> when the user enters some free text.</td>
                    <td><code>{_isFreeTextEntry: true}</code></td>
                </tr>
                <tr>
                    <td>inputTextProperty</td>
                    <td>Name of the property which will be filled into the input field when the user selects an entry. This property is also used for auto-completion.</td>
                    <td><code>'displayValue'</code></td>
                </tr>
                <tr>
                    <td>childrenProperty</td>
                    <td>Name of the property containing the children of a node.</td>
                    <td><code>'children'</code></td>
                </tr>
                <tr>
                    <td>expandedProperty</td>
                    <td>Name of the property indicating whether or not the node is expanded.</td>
                    <td><code>'expanded'</code></td>
                </tr>
                <tr>
                    <td>templates</td>
                    <td>
                        Array of Mustache templates to be used for the entries. <code>templates[0]</code> corresponds to the first nesting level (root nodes). <code>templates[1]</code> correspond to the second nesting level, and so on.<br/>
                        The last array entry (<code>templates[templates.length - 1]</code>) is used for all consecutive nesting levels.
                    </td>
                    <td><code>TrivialComponents.icon2LinesTemplate</code></td>
                </tr>
                <tr>
                    <td>selectedEntryTemplate</td>
                    <td>Mustacheustache template to be used for displaying the currently selected entry.</td>
                    <td>Same as <code>template</code></td>
                </tr>
                <tr>
                    <td>spinnerTemplate</td>
                    <td>Html code for the "loading..." indicator.</td>
                    <td><code>defaultSpinnerTemplate</code></td>
                </tr>
                <tr>
                    <td>noEntriesTemplate</td>
                    <td>Html code for indicating that there is no entry in the dropdown.</td>
                    <td><code>defaultNoEntriesTemplate</code></td>
                </tr>
                <tr>
                    <td>entries</td>
                    <td>Arrays containing the root nodes of the dropdown tree to be displayed initially.</td>
                    <td><code>[]</code></td>
                </tr>
                <tr>
                    <td>selectedEntry</td>
                    <td>The initially selected entry.</td>
                    <td><code>undefined</code></td>
                </tr>
                <tr>
                    <td>emptyEntry</td>
                    <td>Fake entry that should be displayed when no entry is selected.</td>
                    <td><code>{}</code></td>
                </tr>
                <tr>
                    <td>queryFunction</td>
                    <td>JavaScript function for retrieving entries depending on the user's input. Takes two parameters:
                        <code>queryString</code> (user input) and
                        <code>resultCallback</code> (should be called with the list retrieved entries).
                    </td>
                    <td>Simple client-side implementation that filters the initially configured <code>entries</code>.</td>
                </tr>
                <tr>
                    <td>autoComplete</td>
                    <td>If true, the component user get auto-completion inside the text field.</td>
                    <td><code>true</code></td>
                </tr>
                <tr>
                    <td>autoCompleteDelay</td>
                    <td>Delay for auto-completion. (This feature may be removed, as there is currently no reason for a delay in auto-completion.)</td>
                    <td><code>0</code></td>
                </tr>
                <tr>
                    <td>showTrigger</td>
                    <td>The trigger is the button-like handle on the side of the combobox. If false: no trigger is shown.</td>
                    <td><code>true</code></td>
                </tr>
                <tr>
                    <td>matchingOptions</td>
                    <td>An object that defines how the entries in the dropdown should be matched and highlighted. Properties are <code>matchingMode</code>, <code>ignoreCase</code> and <code>maxLevenshteinDistance</code>, <br>
                        Possible values for <code>matchingMode</code>:
                        <ul>
                            <li><code>'contains'</code></li>
                            <li><code>'prefix'</code></li>
                            <li><code>'prefix-word'</code></li>
                            <li><code>'prefix-levenshtein'</code> (<i>experimental</i>)</li>
                            <li><code>'levenshtein'</code> (<i>experimental</i>)</li>
                        </ul>
                    </td>
                    <td><code>{matchingMode: 'contains', ignoreCase: true, maxLevenshteinDistance: 2}</code></td>
                </tr>
                </tbody>
            </table>
        </div>

    </div> <!-- container -->
</div>

@@include('includes/footer.html')
@@include('includes/scripts.html')

<script>
    $(function () {

        $('#entries').val(JSON.stringify(createDemoTreeNodes(), null, 2));
        $('#spinnerTemplate').val(TrivialComponents.defaultSpinnerTemplate);
        $('#noEntriesTemplate').val(TrivialComponents.defaultNoEntriesTemplate);

        $('#selectedEntryTemplate').each(function() {
            $(this).TrivialComboBox({
                template: TrivialComponents.icon2LinesTemplate,
                entries: [{
                    displayValue: "Image with two lines of text",
                    value: TrivialComponents.image2LinesTemplate,
                    additionalInfo: 'TrivialComponents.image2LinesTemplate',
                    imageUrl: 'img/icons/dev.png'
                }, {
                    displayValue: "Round image with two lines of text and status buble",
                    value: TrivialComponents.roundImage2LinesColorBubbleTemplate,
                    additionalInfo: "TrivialComponents.roundImage2LinesColorBubbleTemplate"  ,
                    imageUrl: 'img/icons/dev.png'
                }, {
                    displayValue: "Icon with two lines of text",
                    value: TrivialComponents.icon2LinesTemplate,
                    additionalInfo: "TrivialComponents.icon2LinesTemplate" ,
                    imageUrl: 'img/icons/dev.png'
                }, {
                    displayValue: "Icon with single line of text",
                    value: TrivialComponents.iconSingleLineTemplate,
                    additionalInfo: "TrivialComponents.iconSingleLineTemplate"  ,
                    imageUrl: 'img/icons/dev.png'
                }, {
                    displayValue: "Single line of text",
                    value: TrivialComponents.singleLineTemplate,
                    additionalInfo: "TrivialComponents.singleLineTemplate"  ,
                    imageUrl: 'img/icons/dev.png'
                }],
                selectedEntry: {
                    displayValue: "Round image with two lines of text and status buble",
                    value: TrivialComponents.roundImage2LinesColorBubbleTemplate,
                    additionalInfo: "TrivialComponents.roundImage2LinesColorBubbleTemplate",
                    imageUrl: 'img/icons/dev.png'
                },
                allowFreeText: false
            })
        });
        $('#templates').TrivialTagBox({
            template: TrivialComponents.icon2LinesTemplate,
            entries: [{
                displayValue: "Image with two lines of text",
                value: TrivialComponents.image2LinesTemplate,
                additionalInfo: 'TrivialComponents.image2LinesTemplate',
                imageUrl: 'img/icons/dev.png'
            }, {
                displayValue: "Round image with two lines of text and status buble",
                value: TrivialComponents.roundImage2LinesColorBubbleTemplate,
                additionalInfo: "TrivialComponents.roundImage2LinesColorBubbleTemplate"  ,
                imageUrl: 'img/icons/dev.png'
            }, {
                displayValue: "Icon with two lines of text",
                value: TrivialComponents.icon2LinesTemplate,
                additionalInfo: "TrivialComponents.icon2LinesTemplate" ,
                imageUrl: 'img/icons/dev.png'
            }, {
                displayValue: "Icon with single line of text",
                value: TrivialComponents.iconSingleLineTemplate,
                additionalInfo: "TrivialComponents.iconSingleLineTemplate"  ,
                imageUrl: 'img/icons/dev.png'
            }, {
                displayValue: "Single line of text",
                value: TrivialComponents.singleLineTemplate,
                additionalInfo: "TrivialComponents.singleLineTemplate"  ,
                imageUrl: 'img/icons/dev.png'
            }],
            selectedEntries: [{
                displayValue: "Round image with two lines of text and status buble",
                value: TrivialComponents.roundImage2LinesColorBubbleTemplate,
                additionalInfo: "TrivialComponents.roundImage2LinesColorBubbleTemplate"  ,
                imageUrl: 'img/icons/dev.png'
            }, {
                displayValue: "Icon with two lines of text",
                value: TrivialComponents.icon2LinesTemplate,
                additionalInfo: "TrivialComponents.icon2LinesTemplate" ,
                imageUrl: 'img/icons/dev.png'
            }, {
                displayValue: "Icon with single line of text",
                value: TrivialComponents.iconSingleLineTemplate,
                additionalInfo: "TrivialComponents.iconSingleLineTemplate"  ,
                imageUrl: 'img/icons/dev.png'
            }],
            allowFreeText: false,
            distinct: false
        });
        $('#matchingMode').TrivialComboBox({
                template: TrivialComponents.singleLineTemplate,
                entries: [{
                    displayValue: "contains"
                },{
                    displayValue: "prefix"
                },{
                    displayValue: "prefix-word"
                }],
                selectedEntry: {
                    displayValue: "contains"
                },
                allowFreeText: false
        });
        $('#editingMode').TrivialComboBox({
            template: TrivialComponents.singleLineTemplate,
            entries: [{
                displayValue: "editable"
            },{
                displayValue: "disabled"
            },{
                displayValue: "readonly"
            }],
            selectedEntry: {
                displayValue: "editable"
            },
            allowFreeText: false
        });

        var customQueryFunction = function (queryString, resultCallback) {
            setTimeout(function () {
                resultCallback(createEntries(100).filter(function (entry) {
                    return entry.displayValue.toLowerCase().indexOf(queryString.toLowerCase()) != -1 || entry.additionalInfo.toLowerCase().indexOf(queryString.toLowerCase()) != -1;
                }));
            }, 1000);
        };

        function reInitReadMore() {
            $('.prettyprint').readmore({
                collapsedHeight: 500,
                moreLink: '<a href="#">Read more...</a>',
                lessLink: '<a href="#">Read less...</a>'
            });
        }


        function createTreeComboBox() {
            $('#treeComboBoxWrapper').empty();
            var $treeComboBoxOriginalInput = $('<input id="treecombobox"/>').appendTo('#treeComboBoxWrapper');
            $treeComboBoxOriginalInput.on('change', function() {
                $('#originalInputValue').text($(this).val());
            });

            var entries = JSON.parse($('#entries').val());
            var matchingOptions = {
                matchingMode: $('#matchingMode').TrivialComboBox().getSelectedEntry().displayValue,
                ignoreCase: $('#ignoreCase').is(':checked')
            };

            var defaultQueryFunction = TrivialComponents.defaultTreeQueryFunctionFactory(entries, matchingOptions, $('#childrenProperty').val(), $('#expandedProperty'));
            var customQueryFunction = function (queryString, resultCallback) {
                setTimeout(function() {defaultQueryFunction(queryString, resultCallback)}, 1000);
            };

            var config = {
                showTrigger: $('#showTrigger').is(':checked'),
                allowFreeText: $('#allowFreeText').is(':checked'),
                freeTextEntryValues: JSON.parse($('#freeTextEntryValues').val()),
                autoComplete: $('#autoComplete').is(':checked'),
                queryFunction: $('#customQueryFunction').is(':checked') ? customQueryFunction : undefined,
                autoCompleteDelay: parseInt($('#autoCompleteDelay').val()),
                valueProperty: $('#valueProperty').val(),
                inputTextProperty: $('#inputTextProperty').val(),
                childrenProperty: $('#childrenProperty').val(),
                expandedProperty: $('#expandedProperty').val(),
                matchingOptions: {
                    matchingMode: $('#matchingMode').TrivialComboBox().getSelectedEntry().displayValue,
                    ignoreCase: $('#ignoreCase').is(':checked')
                },
                animationDuration: parseInt($("#animationDuration").val()),
                templates: $('#templates').TrivialTagBox().getSelectedEntries().map(function (v) {
                    return v.value
                }),
                selectedEntryTemplate: $('#selectedEntryTemplate').TrivialComboBox().getSelectedEntry().value,
                spinnerTemplate: $('#spinnerTemplate').val(),
                noEntriesTemplate: $('#noEntriesTemplate').val(),
                selectedEntry: JSON.parse($('#selectedEntry').val()),
                emptyEntry: JSON.parse($('#emptyEntry').val()),
                entries: entries,
                editingMode: $('#editingMode').TrivialComboBox().getSelectedEntry().displayValue
            };
            $('#configDisplay').removeClass("prettyprinted")
                    .text("$('#treecombobox').TrivialTreeComboBox(" + JSON.stringify(config, function(key, value) {
                        if (key === 'queryFunction' && config.queryFunction) {
                            return "%queryFunction%";
                        } else {
                            return value;
                        }
                    }, 2).replace("\"%queryFunction%\"", customQueryFunction.toString()) + ");");
            var trivialTreeComboBox = $treeComboBoxOriginalInput.TrivialTreeComboBox(config);

            function updateSelectedEntryDisplay() {
                $('#selectedEntryDisplay')
                        .text(JSON.stringify(trivialTreeComboBox.getSelectedEntry(), null, 2))
                        .removeClass("prettyprinted");
                prettyPrint();
            }

            updateSelectedEntryDisplay();
            trivialTreeComboBox.$.change(function() {
                updateSelectedEntryDisplay();
                reInitReadMore();
            });
            prettyPrint();
            reInitReadMore();
        }
        createTreeComboBox();

        $('#config input, #config textarea').change(function() {
            createTreeComboBox();
        });
    });
</script>

@@include('includes/ga.html')

</body>
</html>