<html lang="en">

@@include('includes/head.html', {"title": "TrivialTree - Trivial Components"})

<body data-spy="scroll" data-target="#navbar">

@@include('includes/nav.html', {"activeNavLink": "showcase"})

<div class="page-content">

    <section class="page-header-box">
        <h1 class="project-name">TrivialTree</h1>
    </section>

    <div class="container">

        @@include('includes/status-note.html', {"status": "alpha"})

        <div class="row">
            <div class="col-sm-5">
                <h3>Options</h3>

                <form id="config">
                    <div class="form-group">
                        <label for="valueProperty">valueProperty</label>
                        <input class="form-control" id="valueProperty" name="valueProperty" value="id"/>
                    </div>
                    <div class="form-group">
                        <label for="childrenProperty">childrenProperty</label>
                        <input class="form-control" id="childrenProperty" name="childrenProperty" value="children"/>
                    </div>
                    <div class="form-group">
                        <label for="expandedProperty">expandedProperty</label>
                        <input class="form-control" id="expandedProperty" name="expandedProperty" value="expanded"/>
                    </div>
                    <div class="form-group">
                        <label for="matchingMode">matchingMode</label>
                        <input id="matchingMode" name="matchingMode"/>
                    </div>
                    <div class="checkbox">
                        <label>
                            <input type="checkbox" id="ignoreCase" name="ignoreCase" checked="checked"> ignoreCase
                        </label>
                    </div>
                    <div class="form-group">
                        <label for="templates">templates</label>
                        <input id="templates" name="templates"/>
                    </div>
                    <div class="form-group">
                        <label for="spinnerTemplate">spinnerTemplate</label>
                <textarea class="form-control code showcase-textarea" id="spinnerTemplate" name="spinnerTemplate"><div class="tr-default-spinner">
                    <div>Fetching data...</div>
                </div></textarea>
                    </div>
                    <div class="form-group">
                        <label for="noEntriesTemplate">noEntriesTemplate</label>
                <textarea class="form-control code showcase-textarea" id="noEntriesTemplate" name="noEntriesTemplate"><div class="tr-default-no-data-display">
                    <div>No matching entries...</div>
                </div></textarea>
                    </div>
                    <div class="form-group">
                        <label for="entries">entries</label>
                <textarea class="form-control code showcase-textarea" id="entries" name="entries">
                </textarea>
                    </div>
                    <div class="form-group">
                        <label for="selectedEntryId">selectedEntryId</label>
                        <input class="form-control" id="selectedEntryId" name="selectedEntryId" value="2"/>
                    </div>
                </form>
            </div>
            <div class="col-sm-7">
                <h3>Result</h3>

                <div id="treeWrapper" style="height: 370px"></div>
                <h4>Original input value</h4>
                <code id="originalInputValue"></code>
                <h4>Selected entry</h4>
                <pre id="selectedEntryDisplay" class="prettyprint lang-js"></pre>
                <h3>Configuration</h3>
                <pre id="configDisplay" class="prettyprint lang-js"></pre>
            </div>
        </div>

        <h3>Configuration Options<a class="anchor" id="configuration"></a></h3>
        <div class="table-responsive">
            <table class="table table-condensed table-hover">
                <thead>
                <tr>
                    <th>Option</th>
                    <th>Description</th>
                    <th>Default</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>valueProperty</td>
                    <td>Name of the property which should be submitted on form submit. Additionally, this property serves to identify nodes in the tree, so it must be unique.</td>
                    <td><code>null</code></td>
                </tr>
                <tr>
                    <td>childrenProperty</td>
                    <td>Name of the property containing the children of a node.</td>
                    <td><code>'children'</code></td>
                </tr>
                <tr>
                    <td>expandedProperty</td>
                    <td>Name of the property indicating whether or not the node is expanded.</td>
                    <td><code>'expanded'</code></td>
                </tr>
                <tr>
                    <td>templates</td>
                    <td>
                        Array of Mustache templates to be used for the entries. <code>templates[0]</code> corresponds to the first nesting level (root nodes). <code>templates[0]</code> correspond to the second nesting level, and so on.<br/>
                        The last array entry (<code>templates[templates.length - 1]</code>) is used for all consecutive nesting levels.
                    </td>
                    <td><code>TrivialComponents.icon2LinesTemplate</code></td>
                </tr>
                <tr>
                    <td>spinnerTemplate</td>
                    <td>Html code for the "loading..." indicator.</td>
                    <td><code>defaultSpinnerTemplate</code></td>
                </tr>
                <tr>
                    <td>noEntriesTemplate</td>
                    <td>Html code for indicating that there is no entry in the dropdown.</td>
                    <td><code>defaultNoEntriesTemplate</code></td>
                </tr>
                <tr>
                    <td>entries</td>
                    <td>Arrays containing the root nodes of the tree to be displayed initially.</td>
                    <td><code>[]</code></td>
                </tr>
                <tr>
                    <td>selectedEntryId</td>
                    <td>The <code>valueProperty</code> of the node that should be initially selected.</td>
                    <td><code>null</code></td>
                </tr>
                <tr>
                    <td>queryFunction</td>
                    <td>JavaScript function for retrieving entries depending on the user's input. Takes two parameters:
                        <code>queryString</code> (user input) and
                        <code>resultCallback</code> (should be called with the list retrieved entries).
                    </td>
                    <td>Simple client-side implementation that filters the initially configured <code>entries</code>.</td>
                </tr>
                <tr>
                    <td>matchingOptions</td>
                    <td>An object that defines how the entries in the dropdown should be matched and highlighted. Properties are <code>matchingMode</code>, <code>ignoreCase</code> and <code>maxLevenshteinDistance</code>, <br>
                        Possible values for <code>matchingMode</code>:
                        <ul>
                            <li><code>'contains'</code></li>
                            <li><code>'prefix'</code></li>
                            <li><code>'prefix-word'</code></li>
                            <li><code>'prefix-levenshtein'</code> (<i>experimental</i>)</li>
                            <li><code>'levenshtein'</code> (<i>experimental</i>)</li>
                        </ul>
                    </td>
                    <td><code>{matchingMode: 'contains', ignoreCase: true, maxLevenshteinDistance: 2}</code></td>
                </tr>
                </tbody>
            </table>
        </div>

        <!--<div class="table-responsive">-->
        <!--&lt;!&ndash;<table class="table table-condensed table-hover">&ndash;&gt;-->
        <!--&lt;!&ndash;<thead>&ndash;&gt;-->
        <!--&lt;!&ndash;<tr>&ndash;&gt;-->
        <!--&lt;!&ndash;<th>Option</th>&ndash;&gt;-->
        <!--&lt;!&ndash;<th>Description</th>&ndash;&gt;-->
        <!--&lt;!&ndash;<th>Default</th>&ndash;&gt;-->
        <!--&lt;!&ndash;</tr>&ndash;&gt;-->
        <!--&lt;!&ndash;</thead>&ndash;&gt;-->
        <!--&lt;!&ndash;<tbody>&ndash;&gt;-->

        <!--&lt;!&ndash;</tbody>&ndash;&gt;-->
        <!--&lt;!&ndash;</table>&ndash;&gt;-->
        <!--</div>-->

    </div>
    <!-- container -->
</div>

@@include('includes/footer.html')
@@include('includes/scripts.html')

<script>
    $(function () {

        var entries = createDemoTreeNodes();
        $('#entries').val(JSON.stringify(entries, null, 2));
        $('#selectedEntry').val(JSON.stringify(entries[0], null, 2));

        $('#templates').TrivialTagBox({
            template: TrivialComponents.singleLineTemplate,
            entries: [{
                displayValue: "Image with two lines of text",
                value: TrivialComponents.image2LinesTemplate
            }, {
                displayValue: "Round image, 2 lines, color bubble",
                value: TrivialComponents.roundImage2LinesColorBubbleTemplate
            }, {
                displayValue: "Icon with two lines of text",
                value: TrivialComponents.icon2LinesTemplate
            }, {
                displayValue: "Icon with single line of text",
                value: TrivialComponents.iconSingleLineTemplate
            }, {
                displayValue: "Single line of text",
                value: TrivialComponents.singleLineTemplate
            }],
            selectedEntries: [{
                displayValue: "Round image, 2 lines, color bubble",
                value: TrivialComponents.roundImage2LinesColorBubbleTemplate
            }, {
                displayValue: "Icon with two lines of text",
                value: TrivialComponents.icon2LinesTemplate
            }, {
                displayValue: "Icon with single line of text",
                value: TrivialComponents.iconSingleLineTemplate
            }],
            allowFreeText: false
        });
        $('#matchingMode').TrivialComboBox({
            template: TrivialComponents.singleLineTemplate,
            entries: [{
                displayValue: "contains"
            }, {
                displayValue: "prefix"
            }, {
                displayValue: "prefix-word"
            }],
            selectedEntry: {
                displayValue: "contains"
            },
            allowFreeText: false
        });

        var customQueryFunction = function (queryString, resultCallback) {
            setTimeout(function () {
                resultCallback(createEntries(100).filter(function (entry) {
                    return entry.displayValue.toLowerCase().indexOf(queryString.toLowerCase()) != -1 || entry.additionalInfo.toLowerCase().indexOf(queryString.toLowerCase()) != -1;
                }));
            }, 1000);
        };

        function reInitReadMore() {
            $('.prettyprint').readmore({
                collapsedHeight: 500,
                moreLink: '<a href="#">Read more...</a>',
                lessLink: '<a href="#">Read less...</a>'
            });
        }

        function createTree() {
            $('#treeWrapper').empty();
            var $treeOriginalInput = $('<input id="tree"/>').appendTo('#treeWrapper');
            $treeOriginalInput.on('change', function () {
                $('#originalInputValue').text($(this).val());
            });
            var config = {
                valueProperty: $('#valueProperty').val(),
                childrenProperty: $('#childrenProperty').val(),
                expandedProperty: $('#expandedProperty').val(),
                queryFunction: $('#customQueryFunction').is(':checked') ? customQueryFunction : undefined,
                matchingOptions: {
                    matchingMode: $('#matchingMode').TrivialComboBox().getSelectedEntry().displayValue,
                    ignoreCase: $('#ignoreCase').is(':checked')
                },
                templates: $('#templates').TrivialTagBox().getSelectedEntries().map(function (v) {
                    return v.value
                }),
                spinnerTemplate: $('#spinnerTemplate').val(),
                noEntriesTemplate: $('#noEntriesTemplate').val(),
                selectedEntryId: $('#selectedEntryId').val(),
                entries: JSON.parse($('#entries').val())
            };
            $('#configDisplay').removeClass("prettyprinted")
                    .text("$('#tree').TrivialTree(" + JSON.stringify(config, function (key, value) {
                        if (key === 'queryFunction' && config.queryFunction) {
                            return "%queryFunction%";
                        } else {
                            return value;
                        }
                    }, 2).replace("\"%queryFunction%\"", customQueryFunction.toString()) + ");");
            var trivialTree = $treeOriginalInput.TrivialTree(config);

            function updateSelectedEntryDisplay() {
                $('#selectedEntryDisplay')
                        .text(JSON.stringify(trivialTree.getSelectedEntry(), null, 2))
                        .removeClass("prettyprinted");
                prettyPrint();
            }

            updateSelectedEntryDisplay();
            trivialTree.$.change(function () {
                updateSelectedEntryDisplay();
                reInitReadMore();
            });
            prettyPrint();
            reInitReadMore();
        }

        createTree();

        $('#config input, #config textarea').change(function () {
            createTree();
        });

    });
</script>

@@include('includes/ga.html')

</body>
</html>